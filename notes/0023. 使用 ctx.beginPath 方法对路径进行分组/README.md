# [0023. 使用 ctx.beginPath 方法对路径进行分组](https://github.com/Tdahuyou/TNotes.canvas/tree/main/notes/0023.%20%E4%BD%BF%E7%94%A8%20ctx.beginPath%20%E6%96%B9%E6%B3%95%E5%AF%B9%E8%B7%AF%E5%BE%84%E8%BF%9B%E8%A1%8C%E5%88%86%E7%BB%84)

<!-- region:toc -->

- [1. 🎯 目标](#1--目标)
- [2. 🫧 评价](#2--评价)
- [3. 💻 demos.1 - `ctx.beginPath()` 的基本使用](#3--demos1---ctxbeginpath-的基本使用)

<!-- endregion:toc -->

## 1. 🎯 目标

- 学会使用 `ctx.beginPath()` 对路径进行分组
- 了解如果不使用分组的话，会存在什么潜在问题

## 2. 🫧 评价

- `ctx.beginPath()` 是一个比较常用的 API，可以对“路径”进行分组，分组的目的主要是为了将样式的作用对象区分开。
- 比如，`ctx.rect()` 就是现描述出一个矩形路径，然后再执行类似 `ctx.stoke()` 或 `ctx.fill()` 的 API 时，才会根据 `ctx` 设置好的描边颜色、填充颜色等样式信息作用到矩形上。如果在绘制多个图形的过程中，没有使用 `ctx.beginPath()` 对路径进行分组的话，那么在描边儿或者填充的时候，后续添加的样式信息，及描边、填充操作，也会作用到已绘制的图形上。
- 这里所谓的“分组”，也可以理解成创建新路径，新路径和旧路径是分开的。
- 比如，你按照以下步骤来绘制两个矩形：
  - 【1】你绘制了一个旧路径的矩形，然后将其描边为蓝色
  - 【2】此时调用 `ctx.beginPath()` 表示接下来要开始绘制新的路径
  - 【3】你绘制了一个新路径的矩形，然后将其填充为红色
  - 由于中间调用了 `ctx.beginPath()`，因此在第 3 步填充的红色不会作用到第 1 步绘制的旧的蓝色描边矩形上。
  - 如果没有第 2 步的话，那么在执行 3 将矩形的颜色填充为红色的时候，1 的矩形也会被填充为红色。

## 3. 💻 demos.1 - `ctx.beginPath()` 的基本使用

- **需求：**
  - 先在 `(50, 50)` 位置绘制一个 `100 x 100` 的矩形轮廓，要求轮廓颜色为蓝色；
  - 再在 `(250, 50)` 位置绘制一个 `100 x 100` 的红色矩形；
- 下面我们将通过上述这俩简单的小需求，体验一下 `ctx.beginPath()` 的作用。

::: code-group

<<< ./demos/1/1.html {17-34} [❌ 错误写法 - 未使用 ctx.beginPath() 对路径进行分组]

:::

- 最终效果：
  - ![img](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2024-10-04-00-52-36.png)
- stroke() 或 fill() 默认会对 **之前所有绘制的路径** 进行一个处理，这种写法在绘制完第一个描边矩形之后，当你绘制第二个填充矩形时，填充将会对之前的路径也起作用。
  - 当 `ctx.stroke()` 执行时
    - `(50, 50)` 位置的矩形：加上了蓝色的描边
  - 当 `ctx.fill()` 执行时
    - `(50, 50)` 位置的矩形：被填充为了红色
    - `(250, 50)` 位置的矩形：被填充为了红色

---

::: code-group

<<< ./demos/1/2.html {17-26} [✅ 正确写法 1 - 使用 ctx.beginPath() 对路径进行分组]

:::

- 最终效果：
  - ![img](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2024-10-04-00-53-46.png)
- 因为在执行 `ctx.fill()` 之前，调用了 `ctx.beginPath()`，相当于对路径做了一个分组，这意味着路径重新开始绘制，别再管之前的路径了。
  - 当 `ctx.stroke()` 执行时
    - `(50, 50)` 位置的矩形：加上了蓝色的描边
  - 当 `ctx.fill()` 执行时
    - ~~`(50, 50)` 位置的矩形：被填充为了红色~~（这是之前的路径，填充 fill 只会对当前的路径进行填充）
    - `(250, 50)` 位置的矩形：被填充为了红色

---

::: code-group

<<< ./demos/1/3.html {} [✅ 正确写法 2 - 使用 ctx.strokeRect()、ctx.fillRect()]

:::

- 最终效果：
  - ![img](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2024-10-04-00-54-27.png)
